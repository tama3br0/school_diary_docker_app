<% if @student.role == 'student' %>
  <h1><%= "#{@student.grade_class.grade}#{@student.grade_class.class_num}#{sprintf('%02d', @student.student_num)}" %>さんのにっきを作成</h1>
<% else %>
  <h1><%= @student.name %>せんせいのにっきを作成</h1>
<% end %>

<div class="new-diary-page">
  <div id="flash_messages">
    <%= render 'layouts/flash' %>
  </div>

  <%= form_with model: @diary, url: create_diary_for_student_path, local: true, class: 'new-diary-form' do |form| %>
    <%= form.hidden_field :user_id, value: @student.id %>

    <div class="new-date-field">
      <%= form.label :date, "日付" %>
      <%= form.date_field :date, value: @diary.date %>
    </div>

    <% @questions.each do |question| %>
      <div class="new-question-container">
        <h3><%= question.text %></h3>
        <div class="new-emotions-container">
          <% question.choose_emotions.each do |emotion| %>
            <div class="new-emotion-item">
              <%= form.radio_button :answers, emotion.id, id: "emotion_#{emotion.id}" %>
              <%= form.label :answers, for: "emotion_#{emotion.id}" do %>
                <%= image_tag emotion.image %>
                <span><%= emotion.text %></span>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <div class="new-submit-container">
      <%= form.submit "にっきを ていしゅつ", class: 'new-submit-button' %>
    </div>
  <% end %>

  <%= link_to '戻る', student_diary_path(@student, date: @diary.date) %>
</div>
